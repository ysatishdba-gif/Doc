# %% Check: do ancestor-descendant relationships exist 
# across multiple hops?
import networkx as nx

cui_set = set(result.all_reduced_cuis)
sample = [c for c in result.all_reduced_cuis if network.has_node(c)][:200]

ancestor_pairs = 0
for cui in sample:
    ancestors = nx.ancestors(network, cui)  # all ancestors, any depth
    overlap = ancestors & cui_set
    if overlap:
        ancestor_pairs += len(overlap)

print(f"Checked: {len(sample)} CUIs")
print(f"Multi-hop ancestor relationships found: {ancestor_pairs}")
