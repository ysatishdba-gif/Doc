import re
cui_pattern = re.compile(r'^C\d{5,}$')

bad_nodes = [n for n in hierarchy.nodes() 
             if not (isinstance(n, str) and cui_pattern.match(n))]

print(f"Bad nodes: {len(bad_nodes)} out of {hierarchy.number_of_nodes()}")
